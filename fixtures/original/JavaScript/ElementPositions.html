<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html dir="ltr" lang="en">
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type">
    <title>Element Positions</title>
    <meta content="caterpillar" name="author">
    <meta content="JavaScript" name="keywords">
    <link href="css/std.css" rel="stylesheet" type="text/css">
  </head>
  <body>
    <div class="header">
      <div class="hgroup">
        <h3><a href="http://openhome.cc/eGossip/">From eGossip@Openhome</a></h3>
        <h1><a href="index.html">JavaScript Essence: Element Positions<br>
          </a></h1>
      </div>
    </div>
    <div class="article">
      <div style="text-align: right;"><a href="../../Gossip/JavaScript/TopLeft.html">中文</a></div>
      <br>
      The CSS <span class="courier">position</span> property specifies the positioning method used for an element. The default value of most elements is <span
        class="courier">static</span>, which renders elements in order in the document flow. Other allowed values include <span
        class="courier">relative</span>, <span class="courier">absolute</span>, <span
        class="courier">fixed</span>, and <span class="courier">inherit</span>. <br>
      <br>
      The position of an element is determined by its <span class="courier">top/left</span> or <span
        class="courier">bottom/right</span> properties. The <span class="courier">top</span> property is the vertical distance from the origin; the positive direction is downward. The <span
        class="courier">left</span> property is the horizontal distance from the origin; the positive direction is rightward. The <span
        class="courier">bottom</span> property is the vertical distance from the origin; the positive direction is upward. The <span
        class="courier">right</span> property is the horizontal distance from the origin; the positive direction is leftward.<br>
      <br>
      An element with <span class="courier">position: absolute</span> is placed relative to the first parent element with a position setting other than <span
        class="courier">static</span>. Absolutely positioned elements can stack together. The <span
        class="courier">z-index</span> property is used to define the stack order. An element with a greater <span
        class="courier">z-index</span> will stack on top of an element with a lower <span
        class="courier">z-index</span>. The default <span class="courier">z-index</span> is the element's defined order in the document; the lately-defined element has a greater <span
        class="courier">z-index</span>. <br>
      <br>
      The following example uses <span class="courier">position: absolute</span> with the <span
        class="courier">top</span>, <span class="courier">left</span>, and <span
        class="courier">z-index</span> properties. Clicking anywhere in the document can change the position of the "message 1" element. Clicking one of the <span
        class="courier">div</span> elements can increase its <span class="courier">z-index</span>. <br>
      <ul>
        <li><a href="samples/ElementPositions-1.html">ElementPositions-1.html</a></li>
      </ul>
      <pre>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Strict//EN"&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;meta content="text/html; charset=UTF-8" http-equiv="content-type"&gt;
        &lt;style type="text/css"&gt;
            #message1 {
                color: #ffffff;
                background-color: #ff0000;
                border-width: 10px;
                border-color: black;
                border-style: solid;
                width: 100px;
                height: 50px;
                padding: 50px;
                margin: 10px;
                position: absolute;
                top: 50px;
                left: 50px;
                z-index: 0;                
            }
            #message2 {
                color: #ffffff;
                background-color: #ff0000;
                border-width: 10px;
                border-color: black;
                border-style: solid;
                width: 100px;
                height: 50px;
                padding: 50px;
                margin: 10px;
                position: absolute;
                top: 150px;
                left: 150px;
                z-index: 0;                
            }
        &lt;/style&gt;
        &lt;script type="text/javascript"&gt;
            window.onload = function(event) {
                var message1 = document.getElementById('message1');
                var message2 = document.getElementById('message2');
                
                document.onclick = function(event) {
                    event = event || window.event;
                    message1.style.left = event.clientX + 'px';
                    message1.style.top = event.clientY + 'px';
                };
                
                function stopPropagation(event) {
                    if(event) {
                        event.stopPropagation();
                    }
                    else {
                        window.event.cancelBubble = true;
                    }
                }
                
                message1.onclick = function(event) {
                    this.style.zIndex = 1;
                    message2.style.zIndex = 0;
                    stopPropagation(event);
                };
                
                message2.onclick = function(event) {
                    this.style.zIndex = 1;
                    message1.style.zIndex = 0;
                    stopPropagation(event);
                };
            };
        &lt;/script&gt;        
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="message1"&gt;message 1&lt;/div&gt;
        &lt;div id="message2"&gt;message 2&lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;</pre>
      <br>
      An element with <span class="courier">position: relative</span> is placed relative to its normal position. The relative position is defined using <span
        class="courier">top/left</span> or <span class="courier">bottom/right</span>. For example, if an element's normal position is <span
        class="courier">100px</span> * <span class="courier">50px</span> and its <span
        class="courier">position</span> is <span class="courier">relative</span>, setting <span
        class="courier">top: 20px</span> and <span class="courier">left: 30px</span> will position the element in (100 + 20) * (50 + 30) = <span
        class="courier">120px</span> * <span class="courier">80px</span>.<br>
      <br>
      A <span class="courier">fixed</span> positioned element is placed relative to the browser view-port. For example, if you want to keep an element positioned in <span
        class="courier">100px</span> * <span class="courier">50px</span> of the view-port after scrolling the document, you can set <span
        class="courier">position: fixed</span>. Then, the <span class="courier">top/left</span> or <span
        class="courier">bottom/right</span> settings are relative to the view-port. Internet Explorer 6 browser doesn't support the <span
        class="courier">fixed</span> value; Internet Explorer 7 and 8 support this setting only if a <span
        class="courier">&lt;!DOCTYPE&gt;</span> is specified.<br>
      <br>
      To get the exact position of an element, we should figure out the element's <span
        class="courier">offsetParent</span>. The <span class="courier">offsetParent</span> isn't the direct parent of an element; it returns the first positioned parent element in the DOM hierarchy. <br>
      <br>
      Every element has the <span class="courier">offsetTop</span> and <span
        class="courier">offsetLeft</span> properties. They represent the distances from the upper left corner of the <span
        class="courier">offsetParent</span> element's outer border. The following example demonstrates how to calculate the exact position of an element in the simple layout. <br>
      <ul>
        <li><a href="samples/ElementPositions-2.html">ElementPositions-2.html</a></li>
      </ul>
      <pre>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Strict//EN"&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;meta content="text/html; charset=UTF-8" http-equiv="content-type"&gt;
        &lt;style type="text/css"&gt;
            #container {
                color: #ffffff;
                background-color: #ff0000;
                border-width: 10px;
                border-color: black;
                border-style: solid;
                width: 100px;
                height: 50px;
                padding: 50px;
                position: absolute;
                top: 50px;
                left: 50px;
            }
            #message {
                position: static;
                top: 20px;
                left: 20px;
            }
        &lt;/style&gt;
        &lt;script type="text/javascript"&gt;
            window.onload = function(event) {
                function offset(element) {
                    var x = 0;
                    var y = 0;
                    while(element) {
                        x += element.offsetLeft;
                        y += element.offsetTop;
                        element = element.offsetParent;
                    }
                    return { 
                        x: x, 
                        y: y, 
                        toString: function() {
                            return '(' + this.x + ', ' + this.y + ')';
                        }
                    };
                }
                
                document.onclick = function(event) {
                    event = event || window.event;
                    var container = document.getElementById('container');
                    container.style.left = event.clientX + 'px';
                    container.style.top = event.clientY + 'px';
                    var message = document.getElementById('message');
                    var console = document.getElementById('console');
                    console.innerHTML = offset(message);
                };                
            };
        &lt;/script&gt;        
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="container"&gt;&lt;span id="message"&gt;This is a message&lt;span&gt;&lt;/div&gt;
        &lt;span id="console"&gt;&lt;/span&gt;
    &lt;/body&gt;
&lt;/html&gt;</pre>
      <br>
      One example which requires the exact position of an element is the search box suggestions. You need to know the search box's position, and then show the suggested keywords below the search box. The following example is a simple demonstration:<br>
      <ul>
        <li><a href="samples/ElementPositions-3.html">ElementPositions-3.html</a></li>
      </ul>
      <pre>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Strict//EN"&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;meta content="text/html; charset=UTF-8" http-equiv="content-type"&gt;
        &lt;style type="text/css"&gt;
            #container {
                color: #ffffff;
                background-color: #ff0000;
                height: 50px;
                position: absolute;
                top: -100px;
                left:-100px;
            }
        &lt;/style&gt;
        &lt;script type="text/javascript"&gt;
            window.onload = function(event) {
                function offset(element) {
                    var x = 0;
                    var y = 0;
                    while(element) {
                        x += element.offsetLeft;
                        y += element.offsetTop;
                        element = element.offsetParent;
                    }
                    return { 
                        x: x, 
                        y: y, 
                        toString: function() {
                            return '(' + this.x + ', ' + this.y + ')';
                        }
                    };
                }
                var input = document.getElementById('search');
                var search = offset(input);
                var container = document.getElementById('container');
                container.style.left = search.x + 'px';
                container.style.top = search.y + input.offsetHeight + 'px';
                container.style.width = input.offsetWidth + 'px';
            };
        &lt;/script&gt;        
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="container"&gt;This is a message&lt;/div&gt;
        &lt;hr&gt;
        Search: &lt;input id="search" type="text"&gt;
    &lt;/body&gt;
&lt;/html&gt;</pre>
      <br>
      Unfortunately, the <span class="courier">offsetParent</span> property has the problem of browser compatibility. In Firefox, the <span
        class="courier">offsetParent</span> property of an <span class="courier">absolute</span> or <span
        class="courier">fixed</span> positioned element returns the <span
        class="courier">body</span> element. The <span class="courier">offsetParent</span> property of a <span
        class="courier">static</span> or <span class="courier">relative</span> positioned element returns the first positioned parent element. But, the <span
        class="courier">offsetParent</span> property of a <span class="courier">relative</span> positioned element returns different elements in different versions of Internet Explorer.<br>
      <br>
      Besides, getting the exact position of an element will becomes more complex in a more complex layout. For example, the CSS <span
        class="courier">overflow</span> property may set a scroll bar, but the offset amount doesn't consider the scroll bar position. If you set the CSS <span
        class="courier">overflow</span> property, you should take the scroll bar into consideration. For example: <br>
      <div class="courier" style="margin-left: 40px;"><span><strong>function offset(element) {</strong></span><span><strong><br>
          </strong></span><span><strong>&nbsp;&nbsp;&nbsp; var x = 0;</strong></span><span><strong><br>
          </strong></span><span><strong>&nbsp;&nbsp;&nbsp; var y = 0;</strong></span><span><strong><br>
          </strong></span><span><strong>&nbsp;&nbsp;&nbsp; for(var e = element; e; e = e.offsetParent) {</strong></span><span><strong><br>
          </strong></span><span><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; x += e.offsetLeft;</strong></span><span><strong><br>
          </strong></span><span><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; y += e.offsetTop;</strong></span><span><strong><br>
          </strong></span><span><strong>&nbsp;&nbsp;&nbsp; }</strong></span><span><strong><br>
          </strong></span><span><strong><br>
          </strong></span><span><strong>&nbsp;&nbsp;&nbsp; // consider a scroll bar's offset</strong></span><span><strong><br>
          </strong></span><span><strong>&nbsp;&nbsp;&nbsp; for(var e = element.parentNode; e &amp;&amp; e != document.body; e = e.parentNode) {</strong></span><span><strong><br>
          </strong></span><span><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(e.scrollLeft) {</strong></span><span><strong><br>
          </strong></span><span><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; x -= e.scrollLeft;</strong></span><span><strong><br>
          </strong></span><span><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</strong></span><span><strong><br>
          </strong></span><span><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(e.scrollTop) {</strong></span><span><strong><br>
          </strong></span><span><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; y -= e.scrollTop;</strong></span><span><strong><br>
          </strong></span><span><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</strong></span><span><strong><br>
          </strong></span><span><strong>&nbsp;&nbsp;&nbsp; }</strong></span><span><strong><br>
          </strong></span><span><strong><br>
          </strong></span><span><strong>&nbsp;&nbsp;&nbsp; return { </strong></span><span><strong><br>
          </strong></span><span><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; x: x, </strong></span><span><strong><br>
          </strong></span><span><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; y: y, </strong></span><span><strong><br>
          </strong></span><span><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; toString: function() {</strong></span><span><strong><br>
          </strong></span><span><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return '(' + this.x + ', ' + this.y + ')';</strong></span><span><strong><br>
          </strong></span><span><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</strong></span><span><strong><br>
          </strong></span><span><strong>&nbsp;&nbsp;&nbsp; };</strong></span><span><strong><br>
          </strong></span><span><strong>}</strong></span><strong><br>
        </strong></div>
      <br>
      <p></p>
      <p></p>
      <ul>
      </ul>
    </div>
    <div class="aside">
      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
      </script> <br>
      <br>
      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
      </script> <br>
      <br>
      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
      </script> <br>
      <br>
      <br>
    </div>
    <script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script> <script type="text/javascript">
_uacct = "UA-143766-1";
urchinTracker();
</script> </body>
</html>
