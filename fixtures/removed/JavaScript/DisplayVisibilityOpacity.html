<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html dir="ltr" lang="en">
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type">
    <title>Display, Visibility and Opacity</title>
    <meta content="caterpillar" name="author">
    <meta content="JavaScript" name="keywords">
    <link href="css/std.css" rel="stylesheet" type="text/css">
  </head>
  <body>
    <div class="header">
      <div class="hgroup">
        <h3><a href="http://openhome.cc/eGossip/">From eGossip@Openhome</a></h3>
        <h1><a href="index.html">JavaScript Essence: Display, Visibility and Opacity<br>
          </a></h1>
      </div>
    </div>
    <div class="article">
      <div style="text-align: right;"><a href="../../Gossip/JavaScript/DisplayVisibilityOpacity.html">中文</a></div>
      <br>
      Hiding and displaying elements are common effects in web pages and have several implementing ways. <br>
      <br>
      Setting the <span class="courier">display</span> property of <span
        class="courier">style</span> can hide or display the element. When <span
        class="courier">display</span> is <span class="courier">none</span>, the element doesn't display at all and the layout doesn't consider it. That's to say, the element doesn't occupy a visible space. Setting <span
        class="courier">display</span> as <span class="courier">block</span> will display the element as a block-level element, such as paragraphs and headers. Setting <span
        class="courier">display</span> as <span class="courier">inline</span> will display the element as an inline-level element, like <span
        class="courier">span</span> elements.<br>
      <br>
      Below is a simple example.<br>
      <ul>
        <li><a href="samples/DisplayVisibilityOpacity-1.html">DisplayVisibilityOpacity-1.html</a></li>
      </ul>
      <pre>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Strict//EN"&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;meta content="text/html; charset=UTF-8" http-equiv="content-type"&gt;
        &lt;style type="text/css"&gt;
            #message {
                color: #ffffff;
                background-color: #ff0000;
                border-width: 10px;
                border-color: black;
                border-style: solid;
                width: 100px;
                height: 50px;
                padding: 50px;
            }
        &lt;/style&gt;
        &lt;script type="text/javascript"&gt;
            window.onload = function(event) {
                function style(obj, prop) {
                    if(window.getComputedStyle) {
                        return window.getComputedStyle(obj, null)[prop];
                    }
                    else if(obj.currentStyle) {
                        return obj.currentStyle[prop];
                    }
                    else {
                        return null;
                    }
                }
                
                function show(element) {
                    element.style.display = element.previousDisplay || '';
                    if(style(element, 'display') === 'none') {
                        var node = document.createElement(element.nodeName);
                        document.body.appendChild(node);
                        element.style.display = style(node, 'display');
                        document.body.removeChild(node);
                    }
                }
                
                function hide(element) {
                    element.previousDisplay = style(element, 'display');
                    element.style.display = 'none';
                }
                
                document.getElementById('toggle').onclick = function() {
                    var message = document.getElementById('message');
                    if(style(message, 'display') === 'none') {
                        show(message);
                    }
                    else {
                        hide(message);
                    }
                };
            };
        &lt;/script&gt;        
    &lt;/head&gt;
    &lt;body&gt;
        &lt;button id='toggle'&gt;Toggle the visible status&lt;/button&gt;
        &lt;hr&gt;
        This is a text! This is a text! This is a text! This is a text! This is a text!
        &lt;div id="message"&gt;Message 1&lt;/div&gt;
        This is other text!This is other text!This is other text!This is other text!This is other text!
    &lt;/body&gt;
&lt;/html&gt;</pre>
      <br>
      In the above example, hiding the <span class="courier">div</span> element is archived through setting its <span
        class="courier">display</span> <span class="courier">none</span>. We also save its original <span
        class="courier">display</span> value. When displaying the element, we recover its original <span
        class="courier">display</span> value if there's one, or use the element's default value. For example, a <span
        class="courier">div</span> element is <span class="courier">block</span>, and a <span
        class="courier">span</span> element is <span class="courier">inline</span>. <br>
      <br>
      Setting the <span class="courier">visibility</span> property of <span
        class="courier">style</span> as <span class="courier">visible</span> or <span
        class="courier">hidden</span> can also display or hide an element. An element with a <span
        class="courier">hidden</span> <span class="courier">visibility</span> won't be displayed, yet the layout will consider it. That's to say, it still occupies a space in the display. <br>
      <br>
      In conclusion, <span class="courier">display</span> is a setting relative to the layout. If <span
        class="courier">display</span> is <span class="courier">none</span>, the element is <span>none</span> in the layout. Since it's none in the layout, it's not visible. The <span
        class="courier">visibility</span> is simply a setting about visual effects. So, if <span
        class="courier">display</span> is <span class="courier">none</span> and <span
        class="courier">visibility</span> is <span class="courier">visible</span>, the element is still not visible because it's not taken into consideration in the layout. If d<span
        class="courier">isplay</span> isn't <span class="courier">none</span> and <span
        class="courier">visibility</span> is <span class="courier">hidden</span>, though the element isn't visible, yet it still occupies a space in the layout. <br>
      <br>
      The opacity of an element also affects its visual effects. An element with the opacity zero, of course, is not visible. It's not common, however, to use the opacity to display or hide an element. The opacity is often used to do translucent, fade-out and fade-in effects. <br>
      <br>
      The setting of an element's opacity has browser-compatible problems. The specification says that you should set the <span
        class="courier">opacity</span> property of <span class="courier">style</span> a number from 0 to 1. The 1 is opaque and 0 is transparent. Internet Explorer says that you should give the <span
        class="courier">filter</span> property of <span class="courier">style</span> the format <span
        class="courier">alpha(opacity=number)</span>, where the number is from 0 to 100. A cross-browser way to set the opacity is as follow:<br>
      <div class="courier" style="margin-left: 40px;"><span><strong>function opacity(element, value) {</strong></span><span><strong><br>
          </strong></span><span><strong>&nbsp;&nbsp;&nbsp; if(style(element, 'opacity') !== undefined) {</strong></span><span><strong><br>
          </strong></span><span><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; element.style.opacity = value;</strong></span><span><strong><br>
          </strong></span><span><strong>&nbsp;&nbsp;&nbsp; }</strong></span><span><strong><br>
          </strong></span><span><strong>&nbsp;&nbsp;&nbsp; else {</strong></span><span><strong><br>
          </strong></span><span><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; element.style.filter = 'alpha(opacity=' + parseInt(value * 100) + ')'</strong></span><span><strong><br>
          </strong></span><span><strong>&nbsp;&nbsp;&nbsp; }</strong></span><span><strong><br>
          </strong></span><span><strong>}</strong></span><strong><br>
        </strong></div>
      <br>
      When an element's opacity is 0, it's not visible. The layout, however, still considers it, so the element still occupies a space. The following example implements simple fade-in and fade-out effects. If an element's opacity has been set, it will recover its origin opacity after fading in.<br>
      <ul>
        <li><a href="samples/DisplayVisibilityOpacity-2.html">DisplayVisibilityOpacity-1.html</a></li>
      </ul>
      <pre>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Strict//EN"&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;meta content="text/html; charset=UTF-8" http-equiv="content-type"&gt;
        &lt;script type="text/javascript"&gt;
            window.onload = function(event) {
                function style(obj, prop) {
                    if(window.getComputedStyle) {
                        return window.getComputedStyle(obj, null)[prop];
                    }
                    else if(obj.currentStyle) {
                        return obj.currentStyle[prop];
                    }
                    else {
                        return null;
                    }
                }
                
                function opacity(element, value) {
                    if(value === undefined) {
                        var opt = style(element, 'opacity') 
                                     || style(element, 'filter');
                        if(opt === '') {
                            return 1;
                        }
                        if(opt.indexOf('alpha') !== -1)  {
                            return opt.substring(14, opt.length - 1) / 100;
                        }
                        return parseFloat(opt);
                    }
                
                    if(style(element, 'opacity') !== undefined) {
                        element.style.opacity = value;
                    }
                    else {
                        element.style.filter = 
                           'alpha(opacity=' + parseInt(value * 100) + ')';
                    }
                }
                
                function fadeIn(element, speed) {
                    speed = speed || 5000;
                    var target = element.previousOpacity || 1;
                    delete element.previousOpacity;
                    var step = target / speed * 500;
                    var opt = 0;
                    setTimeout(function next() {
                        opt += step;
                        if(opt &lt; target) {
                            opacity(element, opt);
                            setTimeout(next);
                        }
                        else {
                            opacity(element, target);
                        }
                    }, 500);
                }                
                
                function fadeOut(element, speed) {
                    speed = speed || 5000;
                    element.previousOpacity = opacity(element);
                    
                    var step = element.previousOpacity / speed * 500;
                    var opt = element.previousOpacity;
                    setTimeout(function next() {
                        opt -= step;
                        if(opt &gt; 0) {
                            opacity(element, opt);
                            setTimeout(next);
                        }
                        else {
                            opacity(element, 0);
                        }
                    }, 500);
                }
                
                var image = document.getElementById('image');
                
                document.getElementById('fadeIn').onclick = function() {
                   fadeIn(image, 10000);
                };
                
                document.getElementById('fadeOut').onclick = function() {
                   fadeOut(image, 10000);
                };
            };
        &lt;/script&gt;        
    &lt;/head&gt;
    &lt;body&gt;
        &lt;button id='fadeOut'&gt;Fade Out&lt;/button&gt;
        &lt;button id='fadeIn'&gt;Fade In&lt;/button&gt;&lt;br&gt;
        &lt;img id="image" src="../images/caterpillar_small.jpg"&gt;
    &lt;/body&gt;
&lt;/html&gt;</pre>
      <br>
      <br>
      <br>
      <p></p>
      <p></p>
      <ul>
      </ul>
    </div>
    <div class="aside">
      
       <br>
      <br>
      
       <br>
      <br>
      
       <br>
      <br>
      <br>
    </div>
     
  </body>
</html>
